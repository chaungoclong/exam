package database;

public class QueryBuilder {
	private StringBuilder query;

	// select
	public QueryBuilder select(String columns) {
		this.query = new StringBuilder();
		this.query.append("SELECT ").append(columns);

		return this;
	}

	// select distinct
	public QueryBuilder selectDistinct(String columns) {
		this.query = new StringBuilder();
		this.query.append("SELECT DISTINCT ").append(columns);

		return this;
	}

	// from
	public QueryBuilder from(String table) {
		this.query.append(" FROM ").append(table);
		return this;
	}

	// where
	public QueryBuilder where(String condition) {
		if (this.query.indexOf("WHERE") != -1) {
			this.query.append(" AND ").append(condition);
		} else {
			this.query.append(" WHERE ").append(condition);
		}

		return this;
	}

	// delete
	public QueryBuilder delete(String table) {
		this.query = new StringBuilder();
		this.query.append("DELETE FROM ").append(table);
		return this;
	}

	// get query
	public String getQuery() {
		return this.query.toString();
	}

	public static void main(String[] args) {
		QueryBuilder query = new QueryBuilder();
		// System.out.println(
		// 		query.selectDistinct("id, age, name").from("class, abc").where("x > ?").where("y > ?").getQuery());
		System.out.println(query.delete("class").where("a > ?").getQuery());
	}
}
